FROM python:3

ENV USER=django
ENV DEBIAN_FRONTEND=noninteractive
ENV PYTHONDONTWRITEBYTECODE=1
ENV PYTHONUNBUFFERED=1
ENV PATH "$PATH:/home/${USER}/.local/bin"

WORKDIR /code

RUN apt update && \
    apt dist-upgrade -y && \
    apt autoremove -y && \
    apt install -y bash && \
    rm -rf /var/lib/apt/lists/*

RUN adduser --system --group ${USER}
RUN chown -R ${USER}:${USER} /code && chmod -R 755 /code
USER ${USER}

ADD ./src/requirements.txt /code/

RUN pip install -r requirements.txt
